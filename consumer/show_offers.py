__author__ = 'Pradeep'from bson.json_util import dumpsfrom django.http import HttpResponse, JsonResponsefrom django.views.decorators.csrf import csrf_exemptimport refrom . import db,jsonResponseimport jsonfailure = dumps({"success":0})@csrf_exemptdef get_qrcode():	data = db.codes	result = data.find().distinct("qrcode")	return result	def get_vendor(location):	data = db.vendors	result = data.find({"address.location":location}).distinct("qrcode")	return resultdef show_offers(request):		try:		location = request.GET['location']	except:		return HttpResponse(failure, content_type="application/json")	location = int(location);	'''active_qrcode=get_qrcode();	active_vendor=get_vendor(location)	qrcode=list(set(active_qrcode) & set(active_vendor))	data=db.offers	query = {"qrcodes":{'$in':qrcode}}	result = data.find(query , {"_id":False,"qrcodes.$":True,"weight":True , "price":True ,"offer_id":True,"img":True })	data=db.banner	query = {"qrcode":{'$in':qrcode}}	result1 = data.find(query , {"_id":False})	'''	if location is 1:		return jsonResponse({"banners": [{"img":"http://agromantra.com/uploads/vendor/banner_31.jpg","type":1,"offer_id":3},{"img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","type":1,"offer_id":2}], "offers": [{"offer_id": 1, "title": "20% off on Fortune Oil","img":"http://agromantra.com/uploads/vendor/banner_31.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 2, "title": "40% off on M.D.H","img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20},{"offer_id": 3, "title": "20% off on Fortune Oil","img":"http://agromantra.com/uploads/vendor/banner_31.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 4, "title": "40% off on M.D.H","img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20},{"offer_id": 5, "title": "20% off on Fortune Oil","img":"http://agromantra.com/uploads/vendor/banner_31.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 6, "title": "40% off on M.D.H","img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20},{"offer_id": 7, "title": "20% off on Fortune Oil","img":"http://agromantra.com/uploads/vendor/banner_31.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 8, "title": "40% off on M.D.H","img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20}], "success": 1})	elif location is 2 :		return jsonResponse({"banners": [{"img":"http://i.imgur.com/QbRBD6M.jpg","type":1,"offer_id":3},{"img":"http://grofers.com/blog/wp-content/uploads/2015/02/Reliance-Fresh2-1.jpg","type":1,"offer_id":2},{"img":"http://4.bp.blogspot.com/-jyuw-AWcTEs/VeAa6qVm0EI/AAAAAAAAHIM/eqOSuuYKRJc/s400/rakhi_banner.jpg","type":1,"offer_id":3}], "offers": [{"offer_id": 1, "title": "20% off on Fortune Oil","img":"http://agromantra.com/uploads/vendor/banner_31.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 2, "title": "40% off on M.D.H","img":"http://martjackstorage.blob.core.windows.net/in-resources/8ebea48a-1ea1-4eba-987d-4f8ab57370a4/Images/ProductImages/Source/ID03082_100.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20},{"offer_id": 3, "title": "10% off on Curd Farm","img":"http://www.bigbasket.com/media/uploads/p/s/40003162_1-milky-mist-curd-farm-fresh.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 4, "title": "25% off on Colgate","img":"http://www.bigbasket.com/media/uploads/p/s/40001077_1-colgate-toothpaste-visible-white.jpg","weight":"500gm","price":"Rs 280","delivery":True,"points":20},{"offer_id": 5, "title": "29% off on Lifebuoy","img":"http://www.daangar.com/wp-content/uploads/2015/03/lifebuoy.jpg","weight":"1.0L","price":"Rs 80","delivery":True,"points":20},{"offer_id": 6, "title": "20% off on MatchBox","img":"http://www.bigbasket.com/media/uploads/p/s/40027412_1-home-lite-matchbox-big.jpg","weight":"500gm","price":"Rs 10","delivery":True,"points":20},{"offer_id": 7, "title": "99% off on Scrubber","img":"http://www.bigbasket.com/media/uploads/p/s/40003996_1-good-home-stainless-steel-scrubber-magnetic-grade.jpg","weight":"1.0L","price":"Rs 20","delivery":True,"points":20},{"offer_id": 8, "title": "20% off on Nescafe","img":"http://www.bigbasket.com/media/uploads/p/s/267376_2-nescafe-coffee-classic.jpg","weight":"500gm","price":"Rs 180","delivery":True,"points":20},{"offer_id": 9, "title": "20% off on Parachute Oil","img":"http://p1.zopnow.com/images/products/320/parachute-parachute-advansed-coconut-hair-oil-300-ml.png","weight":"500gm","price":"Rs 140","delivery":True,"points":20},{"offer_id": 10, "title": "20% off on Maggi","img":"http://www.quizified.in/uploads/266165_1-maggi-meri-masala.jpg","weight":"500gm","price":"Rs 80","delivery":True,"points":20}],"success": 1});	'''success = dumps()	return HttpResponse(success, content_type="application/json")'''		def getLocation(request):	data = db.locations	try:		area = request.GET['area']	except:		return HttpResponse(failure, content_type="application/json")	query = {"area":area}	result = data.find(query, {"_id":False,"locations": True})	success = dumps({"success": 1, "data": result['data'][0]['location'], "total": result.count()})	return HttpResponse(success, content_type="application/json")